# Анализ технического долга проекта AdGram

## Признаки технического долга

1. **Непонятный / нечитабельный код**  
   В некоторых частях кода, особенно в методах, связанных с обработкой данных (например, `ChannelService.getChannelInfoByName`), отсутствуют комментарии, что затрудняет понимание логики. Также в некоторых местах используются "магические числа" и строки, которые не объяснены.

2. **Дублирующийся код**  
   В коде есть дублирование, например, в методах `ChannelService.addChannel` и `ChannelService.updateChannel`, где происходит заполнение полей `ChannelDTO`. Это можно вынести в отдельный метод.

3. **Отсутствие автоматизации (тестов, сборки, развёртывания)**  
   В проекте отсутствуют автоматические тесты для ключевых компонентов, таких как `ChannelController`, `UserController` и `ChannelService`. Также нет настроенной системы CI/CD для автоматической сборки и деплоя.

4. **Запутанная архитектура и ненужные сложные зависимости**  
   Взаимодействие между фронтендом и бэкендом через REST API организовано, но отсутствует четкое разделение ответственности между слоями (например, в `ChannelService` происходит и бизнес-логика, и вызов внешних скриптов).

5. **Медленные / неэффективные средства**  
   В проекте используется вызов внешнего Python-скрипта через `ProcessBuilder` в `ChannelService.getChannelInfoByName`, что может быть неэффективным и сложным для поддержки. Возможно, стоит рассмотреть интеграцию через API или использование более производительных библиотек.

6. **Незакоммиченный код / долгоживущие ветки**  
   В репозитории могут присутствовать долгоживущие ветки без регулярных слияний, что может привести к конфликтам. Необходимо внедрить стратегию ветвления (например, Git Flow).

7. **Отсутствие / несоответствие технической документации**  
   Документация по API и архитектуре проекта отсутствует или не соответствует текущему состоянию. Например, нет описания эндпоинтов в `ChannelController` и `UserController`.

8. **Отсутствие тестовой среды**  
   Нет отдельной среды для тестирования новых функций перед их внедрением в основную ветку. Это может привести к ошибкам в продакшн-окружении.

9. **Длинные циклы интеграции / отсутствие непрерывной интеграции**  
   Отсутствие настроенной системы CI/CD приводит к длительным циклам интеграции и возможным ошибкам при ручном деплое.

---

## План мероприятий по устранению технического долга

1. **Улучшение читаемости кода**  
   - Добавить комментарии к сложным участкам кода, например, в `ChannelService.getChannelInfoByName`.  
   - Убрать "магические числа" и строки, заменив их на константы или конфигурационные параметры.

2. **Рефакторинг дублирующегося кода**  
   - Вынести общую логику заполнения полей `ChannelDTO` в отдельный метод в `ChannelService`.  
   - Упростить методы `addChannel` и `updateChannel`.

3. **Внедрение автоматического тестирования**  
   - Написать юнит-тесты для `ChannelController`, `UserController` и `ChannelService`.  
   - Настроить интеграционные тесты для проверки взаимодействия фронтенда и бэкенда.

4. **Оптимизация архитектуры**  
   - Разделить ответственность в `ChannelService`: вынести вызов внешних скриптов в отдельный сервис.  
   - Упростить взаимодействие между слоями, используя мапперы.

5. **Обновление используемых библиотек**  
   - Провести аудит используемых библиотек и обновить их до актуальных версий.  
   - Рассмотреть замену вызова Python-скрипта на более эффективное решение.

6. **Управление ветками**  
   - Внедрить стратегию ветвления (например, Git Flow).  
   - Регулярно сливать изменения из feature-веток в основную.

7. **Обновление документации**  
   - Создать документацию по API с использованием Swagger или аналогичного инструмента.  
   - Описать архитектуру проекта и ключевые компоненты.

8. **Создание тестовой среды**  
   - Настроить отдельную среду для тестирования, идентичную продакшн-окружению.  
   - Внедрить автоматическое развертывание в тестовую среду.

9. **Внедрение системы непрерывной интеграции/развёртывания (CI/CD)**  
   - Настроить CI/CD с использованием GitHub Actions или Jenkins.  
   - Автоматизировать сборку, тестирование и деплой.

---

## Оценка плана мероприятий

| Мероприятие                          | Сложность | Приоритет | Ожидаемый результат                          | Время (чел.-ч) |
|--------------------------------------|-----------|-----------|---------------------------------------------|---------------|
| Улучшение читаемости кода            | Низкая    | Высокий   | Упрощение поддержки и понимания кода        | 3            |
| Рефакторинг дублирующегося кода      | Средняя   | Высокий   | Снижение количества ошибок и упрощение кода | 8             |
| Внедрение автоматического тестирования | Высокая  | Низкий   | Повышение надежности и стабильности         | 14            |
| Оптимизация архитектуры              | Низкая  | Средний   | Упрощение модификации и тестирования        | 2            |
| Обновление используемых библиотек    | Низкая   | Средний   | Повышение производительности и безопасности | 1            |
| Управление ветками                   | Низкая    | Высокий   | Упрощение процесса разработки               | 1             |
| Обновление документации              | Средняя   | Средний   | Упрощение onboarding новых разработчиков    | 4            |
| Создание тестовой среды              | Высокая  | Низкая   | Снижение риска ошибок в продакшене          | 7            |
| Внедрение CI/CD                      | Высокая  | Высокий   | Ускорение процессов интеграции и деплоя     | 6            |

---

## Сравнение объёма долга и недоимплементированных фич

Технический долг в проекте не очень значительный, сильнее в части автоматизации тестирования, обновлении документации и CI/CD. Стоит отдать приоритет устранению долга, чтобы снизить риски при добавлении новых фич.

---

## Выводы и рекомендации

Технический долг в проекте AdGram требует внимания, особенно в части автоматизации тестирования, обновлении документации и внедрения CI/CD. Рекомендуется начать с наиболее критичных областей, таких как автоматизация тестирования и улучшение читаемости кода, чтобы снизить риски и упростить дальнейшую разработку. Также важно улучшить процессы управления ветками и обновить документацию, чтобы облегчить работу команды и onboarding новых разработчиков.
